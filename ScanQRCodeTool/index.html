<script src="html5-qrcode.min.js"></script>
<style>
    .result {
        background-color: green;
        color: #fff;
        padding: 20px;
    }
    .row {
        display: flex;
    }
</style>

<div class="row">
    <div class="col">
        <div style="width: 500px" id="reader"></div>
    </div>
    <div class="col" style="padding: 30px">
        <h4>SCAN RESULT</h4>
        <div id="result">Result Here</div>
    </div>
</div>

<script type="text/javascript">
    function sleep(ms) {
        return new Promise((resolve) => setTimeout(resolve, ms));
    }
    async function onScanSuccess(qrCodeToken) {
        await fetch(`http://localhost:3000/qrcode/`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ token: qrCodeToken }),
            // mode: 'no-cors',
        })
            .then((response) => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then((numberPlate) => {
                document.getElementById('result').innerHTML = '<span class="result">' + numberPlate + '</span>';

                console.log('Success:', data);
            })
            .catch((error) => {
                console.error('Error:', error);
            });
        html5QrcodeScanner.clear();
    }

    async function onScanError(errorMessage) {
        //handle scan error
    }

    var html5QrcodeScanner = new Html5QrcodeScanner('reader', { fps: 10, qrbox: 250 });
    html5QrcodeScanner.render(onScanSuccess, onScanError);
</script>
